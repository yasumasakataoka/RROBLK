2013-09-08 22:16:27 +0900   jqgrid  jQuery("#div_r_itms_div_r_custords").replaceWith('<div id="div_r_itms_div_r_custords"> <script type="text/javascript"> var lastsel; var cellNames = ["loca_code_cust","loca_name_cust","itm_code","itm_name","custord_duedate","custord_expiredate","custord_remark","custord_infomation","custord_lineno","custord_sno","custord_orderno","custord_toduedate","custord_isudate","custord_amt","custord_price","custord_qty","person_name_upd","person_email_upd","person_remark_upd","usergroup_code_upd","usergroup_name_upd","custord_update_ip","custord_created_at","custord_updated_at","id","custord_id","custord_loca_id_cust","loca_abbr_cust","loca_zip_cust","loca_country_cust","loca_prfct_cust","loca_addr1_cust","loca_addr2_cust","loca_tel_cust","loca_fax_cust","loca_mail_cust","loca_remark_cust","custord_itm_id","itm_itmtype","itm_consumtype","unit_code","unit_name","unit_remark","itm_std","itm_model","person_code_upd","custord_person_id_upd","usergroup_name_chrg","usergroup_code_chrg","person_remark_chrg","person_email_chrg","person_name_chrg","person_code_chrg","custord_person_id_chrg","itm_remark","itm_minqty","itm_packqty","itm_deth","itm_length","itm_material","itm_design","itm_weight"]; jQuery(document).ready(function(){ var mygrid = jQuery("#r_itms_div_r_custords").jqGrid({ url:"/screen/disp?q=r_itms_div_r_custords", editurl:"/screen/add_upd_del", datatype: "xml", colNames:["locacodecust","locanamecust","品目code","品目name","custordduedate","custordexpiredate","custordremark","custordinfomation","custordlineno","custordsno","custordorderno","custordtoduedate","custordisudate","custordamt","custordprice","custordqty","personnameupd","personemailupd","personremarkupd","usergroupcodeupd","usergroupnameupd","custordupdateip","custordcreatedat","custordupdatedat","","","","locaabbrcust","locazipcust","locacountrycust","locaprfctcust","locaaddr1cust","locaaddr2cust","locatelcust","locafaxcust","locamailcust","locaremarkcust","","品目itmtype","品目consumtype","unitcode","unitname","unitremark","品目std","品目model","personcodeupd","","usergroupnamechrg","usergroupcodechrg","personremarkchrg","personemailchrg","personnamechrg","personcodechrg","","品目remark","品目minqty","品目packqty","品目deth","品目length","品目material","品目design","品目weight"], colModel:[{name:"loca_code_cust", index:"loca_code_cust",hidden:false,editrules:{required:true},width:240,search:true,editable:true,formoptions:{rowpos:14,colpos:1} },{name:"loca_name_cust", index:"loca_name_cust",hidden:false,editrules:{required:true},width:300,search:true,editable:true,formoptions:{rowpos:14,colpos:2} },{name:"itm_code", index:"itm_code",hidden:false,editrules:{required:true},width:240,search:true,editable:true,formoptions:{rowpos:15,colpos:1} },{name:"itm_name", index:"itm_name",hidden:false,editrules:{required:true},width:300,search:true,editable:true,formoptions:{rowpos:15,colpos:2} },{name:"custord_duedate", index:"custord_duedate",hidden:false,editrules:{date:true},width:66,search:true,editable:true,formoptions:{rowpos:2,colpos:1} },{name:"custord_expiredate", index:"custord_expiredate",hidden:false,editrules:{date:true},width:60,search:true,editable:true,formoptions:{rowpos:13,colpos:1} },{name:"custord_remark", index:"custord_remark",hidden:false,editrules:{required:false},width:300,search:true,editable:true,edittype:"textarea",editoptions:{rows:"2",cols:"80"},formoptions:{rowpos:12,colpos:1} },{name:"custord_infomation", index:"custord_infomation",hidden:false,editrules:{required:false},width:300,search:true,editable:true,edittype:"textarea",editoptions:{rows:"10",cols:"80"},formoptions:{rowpos:11,colpos:1} },{name:"custord_lineno", index:"custord_lineno",hidden:false,editrules:{number:true},width:132,search:true,editable:true,formoptions:{rowpos:10,colpos:1} },{name:"custord_sno", index:"custord_sno",hidden:false,editrules:{required:false},width:240,search:true,editable:true,formoptions:{rowpos:9,colpos:1} },{name:"custord_orderno", index:"custord_orderno",hidden:false,editrules:{required:false},width:240,search:true,editable:true,formoptions:{rowpos:8,colpos:1} },{name:"custord_toduedate", index:"custord_toduedate",hidden:false,editrules:{date:true},width:66,search:true,editable:true,formoptions:{rowpos:3,colpos:1} },{name:"custord_isudate", index:"custord_isudate",hidden:false,editrules:{date:true},width:66,search:true,editable:true,formoptions:{rowpos:4,colpos:1} },{name:"custord_amt", index:"custord_amt",hidden:false,editrules:{number:true},width:132,search:true,editable:true,formoptions:{rowpos:7,colpos:1} },{name:"custord_price", index:"custord_price",hidden:false,editrules:{number:true},width:132,search:true,editable:true,formoptions:{rowpos:6,colpos:1} },{name:"custord_qty", index:"custord_qty",hidden:false,editrules:{number:true},width:132,search:true,editable:true,formoptions:{rowpos:5,colpos:1} },{name:"person_name_upd", index:"person_name_upd",hidden:false,editrules:{required:false},width:60,search:true,editable:false,formoptions:{rowpos:16,colpos:1} },{name:"person_email_upd", index:"person_email_upd",hidden:false,editrules:{required:false},width:60,search:true,editable:false,formoptions:{rowpos:17,colpos:1} },{name:"person_remark_upd", index:"person_remark_upd",hidden:false,editrules:{required:false},width:60,search:true,editable:false,formoptions:{rowpos:18,colpos:1} },{name:"usergroup_code_upd", index:"usergroup_code_upd",hidden:false,editrules:{required:false},width:60,search:true,editable:false,formoptions:{rowpos:19,colpos:1} },{name:"usergroup_name_upd", index:"usergroup_name_upd",hidden:false,editrules:{required:false},width:60,search:true,editable:false,formoptions:{rowpos:20,colpos:1} },{name:"custord_update_ip", index:"custord_update_ip",hidden:false,editrules:{required:false},width:60,search:true,editable:false,formoptions:{rowpos:21,colpos:1} },{name:"custord_created_at", index:"custord_created_at",hidden:false,editrules:{date:true},width:66,search:true,editable:false,formoptions:{rowpos:22,colpos:1} },{name:"custord_updated_at", index:"custord_updated_at",hidden:false,editrules:{date:true},width:66,search:true,editable:false,formoptions:{rowpos:23,colpos:1} },{name:"id", index:"id",hidden:true,editrules:{number:true},width:132,search:true,editable:false,formoptions:{rowpos:24,colpos:1} },{name:"custord_id", index:"custord_id",hidden:true,editrules:{number:true},width:132,search:true,editable:false,formoptions:{rowpos:25,colpos:1} },{name:"custord_loca_id_cust", index:"custord_loca_id_cust",hidden:true,editrules:{number:true},width:132,search:true,editable:false,formoptions:{rowpos:26,colpos:1} },{name:"loca_abbr_cust", index:"loca_abbr_cust",hidden:false,editrules:{required:false},width:300,search:true,editable:false,formoptions:{rowpos:27,colpos:1} },{name:"loca_zip_cust", index:"loca_zip_cust",hidden:false,editrules:{required:false},width:60,search:true,editable:false,formoptions:{rowpos:28,colpos:1} },{name:"loca_country_cust", index:"loca_country_cust",hidden:false,editrules:{required:false},width:120,search:true,editable:false,formoptions:{rowpos:29,colpos:1} },{name:"loca_prfct_cust", index:"loca_prfct_cust",hidden:false,editrules:{required:false},width:120,search:true,editable:false,formoptions:{rowpos:30,colpos:1} },{name:"loca_addr1_cust", index:"loca_addr1_cust",hidden:false,editrules:{required:false},width:300,search:true,editable:false,formoptions:{rowpos:31,colpos:1} },{name:"loca_addr2_cust", index:"loca_addr2_cust",hidden:false,editrules:{required:false},width:300,search:true,editable:false,formoptions:{rowpos:32,colpos:1} },{name:"loca_tel_cust", index:"loca_tel_cust",hidden:false,editrules:{required:false},width:120,search:true,editable:false,formoptions:{rowpos:33,colpos:1} },{name:"loca_fax_cust", index:"loca_fax_cust",hidden:false,editrules:{required:false},width:120,search:true,editable:false,formoptions:{rowpos:34,colpos:1} },{name:"loca_mail_cust", index:"loca_mail_cust",hidden:false,editrules:{required:false},width:120,search:true,editable:false,formoptions:{rowpos:35,colpos:1} },{name:"loca_remark_cust", index:"loca_remark_cust",hidden:false,editrules:{required:false},width:300,search:true,editable:false,formoptions:{rowpos:36,colpos:1} },{name:"custord_itm_id", index:"custord_itm_id",hidden:true,editrules:{number:true},width:132,search:true,editable:false,formoptions:{rowpos:37,colpos:1} },{name:"itm_itmtype", index:"itm_itmtype",hidden:false,editrules:{required:false},width:6,search:true,editable:false,formoptions:{rowpos:38,colpos:1} },{name:"itm_consumtype", index:"itm_consumtype",hidden:false,editrules:{required:false},width:6,search:true,editable:false,formoptions:{rowpos:39,colpos:1} },{name:"unit_code", index:"unit_code",hidden:false,editrules:{required:false},width:18,search:true,editable:false,formoptions:{rowpos:40,colpos:1} },{name:"unit_name", index:"unit_name",hidden:false,editrules:{required:false},width:60,search:true,editable:false,formoptions:{rowpos:41,colpos:1} },{name:"unit_remark", index:"unit_remark",hidden:false,editrules:{required:false},width:300,search:true,editable:false,formoptions:{rowpos:42,colpos:1} },{name:"itm_std", index:"itm_std",hidden:false,editrules:{required:false},width:300,search:true,editable:false,formoptions:{rowpos:43,colpos:1} },{name:"itm_model", index:"itm_model",hidden:false,editrules:{required:false},width:300,search:true,editable:false,formoptions:{rowpos:44,colpos:1} },{name:"person_code_upd", index:"person_code_upd",hidden:false,editrules:{required:false},width:60,search:true,editable:false,formoptions:{rowpos:45,colpos:1} },{name:"custord_person_id_upd", index:"custord_person_id_upd",hidden:true,editrules:{number:true},width:60,search:true,editable:false,formoptions:{rowpos:46,colpos:1} },{name:"usergroup_name_chrg", index:"usergroup_name_chrg",hidden:false,editrules:{required:false},width:120,search:true,editable:false,formoptions:{rowpos:47,colpos:1} },{name:"usergroup_code_chrg", index:"usergroup_code_chrg",hidden:false,editrules:{required:false},width:180,search:true,editable:false,formoptions:{rowpos:48,colpos:1} },{name:"person_remark_chrg", index:"person_remark_chrg",hidden:false,editrules:{required:false},width:300,search:true,editable:false,formoptions:{rowpos:49,colpos:1} },{name:"person_email_chrg", index:"person_email_chrg",hidden:false,editrules:{required:false},width:300,search:true,editable:false,formoptions:{rowpos:50,colpos:1} },{name:"person_name_chrg", index:"person_name_chrg",hidden:false,editrules:{required:false},width:300,search:true,editable:true,formoptions:{rowpos:1,colpos:2} },{name:"person_code_chrg", index:"person_code_chrg",hidden:false,editrules:{required:true},width:60,search:true,editable:true,formoptions:{rowpos:1,colpos:1} },{name:"custord_person_id_chrg", index:"custord_person_id_chrg",hidden:true,editrules:{number:true},width:132,search:true,editable:false,formoptions:{rowpos:51,colpos:1} },{name:"itm_remark", index:"itm_remark",hidden:false,editrules:{required:false},width:300,search:true,editable:false,formoptions:{rowpos:52,colpos:1} },{name:"itm_minqty", index:"itm_minqty",hidden:false,editrules:{number:true},width:132,search:true,editable:false,formoptions:{rowpos:53,colpos:1} },{name:"itm_packqty", index:"itm_packqty",hidden:false,editrules:{number:true},width:132,search:true,editable:false,formoptions:{rowpos:54,colpos:1} },{name:"itm_deth", index:"itm_deth",hidden:false,editrules:{number:true},width:132,search:true,editable:false,formoptions:{rowpos:55,colpos:1} },{name:"itm_length", index:"itm_length",hidden:false,editrules:{number:true},width:132,search:true,editable:false,formoptions:{rowpos:56,colpos:1} },{name:"itm_material", index:"itm_material",hidden:false,editrules:{required:false},width:300,search:true,editable:false,formoptions:{rowpos:57,colpos:1} },{name:"itm_design", index:"itm_design",hidden:false,editrules:{required:false},width:300,search:true,editable:false,formoptions:{rowpos:58,colpos:1} },{name:"itm_weight", index:"itm_weight",hidden:false,editrules:{number:true},width:132,search:true,editable:false,formoptions:{rowpos:59,colpos:1} }], pager: jQuery("#r_itms_div_r_custords_pager"), rowNum:50, rowList:[50,250,1000,10000], imgpath: "/images/jqgrid", viewrecords: true, height: 200, sortname: "", sortorder: "", multiSort:true, gridview: false, shrinkToFit: false, scrollrows: true, autowidth: true, rownumbers: false, multiselect: false, onCellSelect:function(rowid, iCol,value,e){ var cellname = cellNames[iCol]; var pare_cellname = "r_itms_div_r_custords".split("_div_"); if(pare_cellname[1]){ if(cellname.match(/_code/i)){ if(window.opener){ jQuery("#"+ pare_cellname[0], window.opener.document).val(value); var screen_name = pare_cellname[0].replace("_code","_name"); org_name = screen_name.split("_name")[0] + "_name"; var rowdata = jQuery("#r_itms_div_r_custords").getRowData(rowid); jQuery("#"+ screen_name, window.opener.document).val(rowdata[org_name]); window.close(); } } } }, caption: "受注" }) .navGrid("#r_itms_div_r_custords_pager", {refresh:true,view:true,edit:true,add:true,del:true,search:false }, {editCaption:"edit 受注",top:100,left:50,width:1200,height:600,dataheight:500,afterShowForm:function(formid) { jQuery("input",formid).change(function(){ var chgname = jQuery(this).attr("name"); var chgval = jQuery(this).val(); if(chgname.match(/_code/i)){ if(chgname.match(/^custord/i)){} else{ var newname = "#"+chgname.replace("_code","_name"); jQuery.getJSON("/screen/code_to_name",{"chgname":chgname,"chgval":chgval},function(data){ jQuery(newname,formid).val(data.name); }) } } }); jQuery("input",formid).click(function(){ var chgname = jQuery(this).attr("name"); var viewval = chgname.split("_"); var newwin; if(chgname.match(/_code/i)){ if(chgname.match(/^custord/i)){} else{ url = "/screen/index?id=" + chgname + "_div_r_" + viewval[0] + "s"; if(!newwin||newwin.closed){ newwin = window.open(url,"blkpopup","width=800,height=300,menubar=no,toolbar=no,status=no,menubar=no,scrollbars=yes");} else{ newwin.focus();} } } });jQuery("#person_name_chrg",formid).attr("disabled",true)},editData:{q:"r_itms_div_r_custords",authenticity_token:"ebguHxJC9TkkYM/mRIofmjkwFRPrtFjb61aSAYhaQOY="}}, {addCaption:"add 受注",top:100,left:50,width:1200,height:600,dataheight:500,afterShowForm:function(formid) { jQuery("input",formid).change(function(){ var chgname = jQuery(this).attr("name"); var chgval = jQuery(this).val(); if(chgname.match(/_code/i)){ if(chgname.match(/^custord/i)){} else{ var newname = "#"+chgname.replace("_code","_name"); jQuery.getJSON("/screen/code_to_name",{"chgname":chgname,"chgval":chgval},function(data){ jQuery(newname,formid).val(data.name); }) } } }); jQuery("input",formid).click(function(){ var chgname = jQuery(this).attr("name"); var viewval = chgname.split("_"); var newwin; if(chgname.match(/_code/i)){ if(chgname.match(/^custord/i)){} else{ url = "/screen/index?id=" + chgname + "_div_r_" + viewval[0] + "s"; if(!newwin||newwin.closed){ newwin = window.open(url,"blkpopup","width=800,height=300,menubar=no,toolbar=no,status=no,menubar=no,scrollbars=yes");} else{ newwin.focus();} } } });jQuery("#person_name_chrg",formid).attr("disabled",true)},editData:{q:"r_itms_div_r_custords",authenticity_token:"ebguHxJC9TkkYM/mRIofmjkwFRPrtFjb61aSAYhaQOY="}}, {caption:"delete 受注",top:100,left:50,width:1200,height:600,dataheight:500,delData:{q:"r_itms_div_r_custords",authenticity_token:"ebguHxJC9TkkYM/mRIofmjkwFRPrtFjb61aSAYhaQOY="}}) .navButtonAdd("#r_itms_div_r_custords_pager",{caption:"",title:$.jgrid.nav.searchtitle, buttonicon :"ui-icon-search", onClickButton:function(){mygrid[0].toggleToolbar() } }) .navButtonAdd("#r_itms_div_r_custords_pager",{ caption:"",title:"copy and add",buttonicon:"ui-icon-copy", onClickButton: function(){ var gsr = jQuery("#r_itms_div_r_custords").getGridParam("selrow"); if(gsr){ jQuery("#r_itms_div_r_custords").editGridRow(gsr,{editCaption:"COPY & ADD",editData:{q:"r_itms_div_r_custords",copy:"yes",authenticity_token:"ebguHxJC9TkkYM/mRIofmjkwFRPrtFjb61aSAYhaQOY="},afterShowForm:function(formid) { jQuery("input",formid).change(function(){ var chgname = jQuery(this).attr("name"); var chgval = jQuery(this).val(); if(chgname.match(/_code/i)){ if(chgname.match(/^custord/i)){} else{ var newname = "#"+chgname.replace("_code","_name"); jQuery.getJSON("/screen/code_to_name",{"chgname":chgname,"chgval":chgval},function(data){ jQuery(newname,formid).val(data.name); }) } } }); jQuery("input",formid).click(function(){ var chgname = jQuery(this).attr("name"); var viewval = chgname.split("_"); var newwin; if(chgname.match(/_code/i)){ if(chgname.match(/^custord/i)){} else{ url = "/screen/index?id=" + chgname + "_div_r_" + viewval[0] + "s"; if(!newwin||newwin.closed){ newwin = window.open(url,"blkpopup","width=800,height=300,menubar=no,toolbar=no,status=no,menubar=no,scrollbars=yes");} else{ newwin.focus();} } } });jQuery("#person_name_chrg",formid).attr("disabled",true)}}); } else { alert("Please select Row") } } , position:"right"}) .navButtonAdd("#r_itms_div_r_custords_pager",{ caption:"",title:"export_to_xlsx",buttonicon:"ui-icon-arrowthickstop-1-s", onClickButton: function() { document.location = "/excelexport/index?q=r_itms_div_r_custords"; } , position:"right" }) .navButtonAdd("#r_itms_div_r_custords_pager",{ caption:"",title:"import_from_xlsx",buttonicon:"ui-icon-arrowthickstop-1-n", onClickButton: function() { document.location = "/importfmxlsx/index?q=r_itms_div_r_custords"; } , position:"right" }) .navButtonAdd("#r_itms_div_r_custords_pager",{ caption:"",title:"prepare print",buttonicon:"ui-icon-print ", onClickButton: function() {jQuery(".prntclass").toggle();}, position:"right" }) .navButtonAdd("#r_itms_div_r_custords_pager",{ caption:"",title:"check",buttonicon:"ui-icon-check", onClickButton: function(){ var q = "r_itms_div_r_custords"; jQuery.get("/screen/chk",{q:q,authenticity_token:"ebguHxJC9TkkYM/mRIofmjkwFRPrtFjb61aSAYhaQOY="},null,"script"); }, position:"right" }); jQuery("#r_itms_div_r_custords").jqGrid("gridResize",{minWidth:350,maxWidth:1500,minHeight:80, maxHeight:700}); mygrid.filterToolbar();mygrid[0].toggleToolbar() }); </script> <p> <span> itm_code : ITEM1000 ; </span> <span> itm_name : 部品1 ; </span> <span> unit_code : PCS ; </span> <span> unit_name : 個 ; </span> </p> <p id="grpsrcr_itms_div_r_custords" ></p> <p id="flash_alert" style="display:none;padding:0.7em;" class="ui-state-highlight ui-corner-all"></p> <table id="r_itms_div_r_custords" class="scroll" cellpadding="0" cellspacing="0"></table> <p id="r_itms_div_r_custords_pager" class="scroll" style="text-indent: 2em;"></p> <p id="r_itms_div_r_custords_select_button"> </p> </div> ');  





2013-09-08 22:16:27 +0900   class #<ScreenController:0x8571768> : LINE 595 command_r  = {:sio_strsql=>"(select * from r_custords where custord_itm_id = 1 )  a ", :sio_classname=>"plsql_blk_paging", :sio_start_record=>1, :sio_end_record=>50, :sio_sord=>"", :sio_search=>"false", :sio_sidx=>"", :sio_viewname=>"r_custords", :sio_code=>"r_custords", :sio_id=>5249, :sio_term_id=>"127.0.0.1", :sio_session_id=>"r_itms_div_r_custords", :sio_command_response=>"C", :sio_session_counter=>5249, :sio_add_time=>2013-09-08 22:16:27 +0900}
2013-09-08 22:16:27 +0900   class #<ScreenController:0x8571768> : LINE 677   strsql = 'select loca_code_cust,loca_name_cust,itm_code,itm_name,custord_duedate,custord_expiredate,custord_remark,custord_infomation,custord_lineno,custord_sno,custord_orderno,custord_toduedate,custord_isudate,custord_amt,custord_price,custord_qty,person_name_upd,person_email_upd,person_remark_upd,usergroup_code_upd,usergroup_name_upd,custord_update_ip,custord_created_at,custord_updated_at,id,custord_id,custord_loca_id_cust,loca_abbr_cust,loca_zip_cust,loca_country_cust,loca_prfct_cust,loca_addr1_cust,loca_addr2_cust,loca_tel_cust,loca_fax_cust,loca_mail_cust,loca_remark_cust,custord_itm_id,itm_itmtype,itm_consumtype,unit_code,unit_name,unit_remark,itm_std,itm_model,person_code_upd,custord_person_id_upd,usergroup_name_chrg,usergroup_code_chrg,person_remark_chrg,person_email_chrg,person_name_chrg,person_code_chrg,custord_person_id_chrg,itm_remark,itm_minqty,itm_packqty,itm_deth,itm_length,itm_material,itm_design,itm_weight from (SELECT rownum  cnt,a.* FROM (select * from r_custords where custord_itm_id = 1 )  a  )  WHERE  cnt <= 50  and  cnt >= 1 ' 
