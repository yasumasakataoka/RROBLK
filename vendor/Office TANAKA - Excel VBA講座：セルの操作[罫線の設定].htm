<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja"><head>
<title>Office TANAKA - Excel VBA講座：セルの操作[罫線の設定]</title>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" href="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/main.css" type="text/css">
<script language="JavaScript" type="text/JavaScript">
<!--
function addBookmark(title,url) {
    if (window.sidebar) {
        window.sidebar.addPanel(title, url,"");
    } else if( document.all ) {
        window.external.AddFavorite( url, title);
    } else if( window.opera && window.print ) {
        return true;
    }
}
//-->
</script>
</head>
<body data-twttr-rendered="true">
<div id="frame">
<!-- トップ画像 -->
<div id="top-image">
<div id="top-flash">
<a href="http://itunes.apple.com/jp/app/id421701668" target="_blank"><img src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/iPhone.png" border="0"></a>
</div>
<br><br>
</div>
<!-- メニュー -->
<div class="menu bubplastic horizontal gray">
<ul>
<li><span class="menu_r"><a href="http://officetanaka.net/"><span class="menu_ar">トップページ</span></a></span></li>
<li><span class="menu_r"><a href="http://officetanaka.net/excel/"><span class="menu_ar">機能と数式</span></a></span></li>
<li><span class="menu_r"><a href="http://officetanaka.net/excel/"><span class="menu_ar">ＶＢＡ</span></a></span></li>
<li><span class="menu_r"><a href="http://officetanaka.net/library/"><span class="menu_ar">ダウンロード</span></a></span></li>
<li><span class="menu_r"><a href="http://officetanaka.net/books/"><span class="menu_ar">拙著</span></a></span></li>
<li><span class="menu_r"><a href="http://officetanaka.net/seminar/"><span class="menu_ar">セミナー</span></a></span></li>
<li><span class="menu_r"><a href="http://officetanaka.net/other/"><span class="menu_ar">その他</span></a></span></li>
</ul>
<br class="clearit">
</div>
<!-- ナビゲート -->
<div id="navi">
<a href="http://officetanaka.net/index.stm">トップページ</a> &gt; 
<a href="http://officetanaka.net/excel/index.htm">Excel</a> &gt; 
<a href="http://officetanaka.net/excel/vba/cell/index.htm">講座：セルの操作</a> &gt; 
</div>
<br>
<div id="contents">
<!--Google AdSense Tag Start-->
<script type="text/javascript"><!--
google_ad_client = "pub-8092962482169671";
/* Unit3 */
google_ad_slot = "0887539173";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript" src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px"><ins id="aswift_0_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" frameborder="0" height="90" scrolling="no" width="728"></iframe></ins></ins>
<!--Google AdSense Tag End-->
<br>
</div><a href="http://officetanaka.net/seminar/seminar1.htm" target="_blank"><img src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/banner.png" style="margin-left: 10px;"></a><div id="contents">
<h1>セルの操作(罫線の設定)</h1>
<iframe style="width: 50px; height: 20px;" title="このエントリーをはてなブックマークに追加" class="hatena-bookmark-button-frame" frameborder="0" height="20" scrolling="no" width="50"></iframe><script type="text/javascript" src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/bookmark_button.js" charset="utf-8" async="async"></script>
　
<iframe data-twttr-rendered="true" title="Twitter Tweet Button" style="width: 167px; height: 20px;" class="twitter-share-button twitter-count-horizontal" src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/tweet_button.htm" allowtransparency="true" frameborder="0" scrolling="no"></iframe><script type="text/javascript" src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/widgets.js"></script>

<iframe src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/like_002.htm" style="border:none; overflow:hidden; width:100px; height:21px;" allowtransparency="true" frameborder="0" scrolling="no"></iframe>
<hr class="titlebar">
<!--Google AdSense Tag Start-->
<script type="text/javascript"><!--
google_ad_client = "pub-8092962482169671";
/* Unit2 */
google_ad_slot = "6895818424";
google_ad_width = 728;
google_ad_height = 15;
//-->
</script>
<script type="text/javascript" src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:15px;margin:0;padding:0;position:relative;visibility:visible;width:728px"><ins id="aswift_1_anchor" style="display:block;border:none;height:15px;margin:0;padding:0;position:relative;visibility:visible;width:728px"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;" frameborder="0" height="15" scrolling="no" width="728"></iframe></ins></ins>
<!--Google AdSense Tag End-->
<br>
<br>
<br>
<h2>BorderオブジェクトとBodersコレクション</h2>
<br>
セルに罫線を引くにはどうしたらいいでしょう？いつものようにマクロ記録してみます。次のコードは、セル範囲A1:C3に格子罫線を引いた操作を記録したものです。ツールバーの[罫線]ボタンで操作しました。<br>
<br>
<div class="box"><pre>Sub Macro1()
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
End Sub
</pre></div>
<br>
思わず目を覆いたくなるボリュームですね(^^; 
このコードを理解して、自分のやりたい部分だけを抜き出すのは大変です。え〜い！それなら、このまま使っちゃえ！・・・って方がほとんどでしょうね。で
も、サンデープログラマならともかく、プログラムを作ってお金を稼いでいる職業プログラマが、このようにマクロ記録で生成されたコードを<strong>精査しないで</strong>そ
のまま使っているのを見るとガッカリします。さらに、そういう方から「やっぱVBAは遅いな。しょせんマクロだしな」などと言われるとカチンときます。た
かが罫線を引くぐらいで上のように冗長なコードを書けば時間もかかります。速度が遅い原因は「VBAだから」ではありません。あなたにスキルがないからで
す。<br>
<br>
閑話休題。セルの罫線は、Rangeオブジェクト内の<strong>Border</strong>オブジェクトで表されます。また、セルの罫線は左右、上下、斜め線などに分かれていますので、それらをひっくるめて<strong>Borders</strong>コレクションとして扱います。つまり、下線など個別の罫線を操作するときは、Borders(〜)として特定するわけです。そうして特定した罫線に対して、線を引いたり消したり、線の種類や色を指定します。<br>
<br>
まず、各罫線を表す<strong>定数</strong>からいきましょう。次の図をご覧ください。<br>
<br>
<img src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/cell-06.jpg"><br>
<br>
こうなってます。たとえば、セルA1の下線は <b>Range("A1").Borders(xlEdgeBottom)</b> と表します。<br>
<br>
Borders(〜)として特定した罫線に対して、罫線の「種類」「太さ」「色」を設定します。種類は <strong>LineStyle</strong>プロパティ、太さは <strong>Weight</strong>プロパティ、色は <strong>ColoeIndex</strong>プロパティです。<br>
<br>
線を引いたり消したりするのは<strong>LineStyle</strong>プロパティの役目です。LineStyleプロパティには「直線」「破線」「一点鎖線」などを表す定数を指定します。直線を表す定数は <strong>xlContinuous</strong> で、罫線を引かない定数は <strong>xlLineStyleNone</strong> です。まずは、この2つを覚えておけばいいでしょう。その他の定数はマクロ記録で調べてください。次のコードは、セルA1の下線を引きます。<br>
<br>
<div class="box"><pre>Sub Sample1()
    Range("A1").<strong>Borders(xlEdgeBottom).LineStyle = xlContinuous</strong>
End Sub
</pre></div>
<br>
太さを決める<strong>Weight</strong>プロパティには、「極細」「標準」などを表す定数を指定します。標準は <strong>xlMedium</strong> ですが、Excelの初期値では細い線 <strong>xlThin</strong> が設定されています。<br>
<br>
色を決める<strong>ColorIndex</strong>プロパティに指定できる数値は、InteriorオブジェクトのColorIndexに指定する数値を同じです。いくつの数値を指定すると何色になるかは、下記「文字色の設定」をご覧ください。ただし、罫線色の自動は <strong>xlAutomatic</strong> です。<br>
<br>
<div id="icon14"><a href="http://officetanaka.net/excel/vba/cell/cell04.htm">文字色の設定</a></div>
<br>
<h2>罫線を簡単に操作するポイント</h2>
<br>
さて、ここまで詳解してきましたが、限られた操作でしたらもっと簡単な方法があります。実は、<strong>Borders</strong>コレクションは<strong>引数を省略すると、格子状罫線全体</strong>を返します。たとえば、セル範囲A1:C3に格子罫線を引くマクロは、正式には次のように書きます。<br>
<br>
<div class="box"><pre>Sub Sample2()
    With Range("A1:C3")
        .Borders(xlEdgeTop).LineStyle = xlContinuous
        .Borders(xlEdgeBottom).LineStyle = xlContinuous
        .Borders(xlEdgeRight).LineStyle = xlContinuous
        .Borders(xlEdgeLeft).LineStyle = xlContinuous
        .Borders(xlInsideVertical).LineStyle = xlContinuous
        .Borders(xlInsideHorizontal).LineStyle = xlContinuous
    End With
End Sub
</pre></div>
<br>
面倒くさいですね。これをBordersコレクションの引数省略方式で書くと、<br>
<br>
<div class="box"><pre>Sub Sample3()
    Range("A1:C3").Borders.LineStyle = xlContinuous
End Sub
</pre></div>
<br>
これだけです。<br>
Sample2とSample3は同じ結果です。ぜひお試しください。<br>
<br>
さらに、LinStyleプロパティに設定する<strong>xlContinuous</strong>(罫線を引く)と<strong>xlLineStyleNone</strong>(罫線を消す)は、実は数値の <strong>1</strong> と <strong>-4142</strong> でも代用できます。また、試したところ、<strong>True</strong> と <strong>False</strong> でもOKなようです。ということは、格子罫線を操作するのはもっと簡単になります。次のコードは、選択したセル範囲に罫線を引きます。<br>
<br>
<div class="box"><pre>Sub Sample4()
    Selection.Borders.LineStyle = <strong>True</strong>
End Sub
</pre></div>
<br>
引いてある罫線を消したいときは、<strong>False</strong> を設定します。<br>
<br>
<br>
<center>
← <a href="http://officetanaka.net/excel/vba/cell/cell06.htm" class="ul">配置の設定</a> | <a href="http://officetanaka.net/excel/vba/cell/cell08.htm" class="ul">表示形式の設定</a> →<br>
</center>
<br>
<br>
<iframe style="width: 50px; height: 20px;" title="このエントリーをはてなブックマークに追加" class="hatena-bookmark-button-frame" frameborder="0" height="20" scrolling="no" width="50"></iframe><script type="text/javascript" src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/bookmark_button.js" charset="utf-8" async="async"></script>
　
<iframe data-twttr-rendered="true" title="Twitter Tweet Button" style="width: 167px; height: 20px;" class="twitter-share-button twitter-count-horizontal" src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/tweet_button_002.htm" allowtransparency="true" frameborder="0" scrolling="no"></iframe><script type="text/javascript" src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/widgets.js"></script>

<iframe src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/like_002.htm" style="border:none; overflow:hidden; width:100px; height:21px;" allowtransparency="true" frameborder="0" scrolling="no"></iframe>
<hr class="titlebar">
<!--Google AdSense Tag Start-->
<script type="text/javascript"><!--
google_ad_client = "pub-8092962482169671";
/* Unit1 */
google_ad_slot = "7810613330";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript" src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px"><ins id="aswift_2_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;" frameborder="0" height="90" scrolling="no" width="728"></iframe></ins></ins>
<!--Google AdSense Tag End-->
<br><br>
<center><input value=" このページをお気に入り(ブックマーク)に登録する " onclick="addBookmark(document.title, location.href);" type="button">　
<input value=" 目次ページに戻る " onclick="location.href='index.htm'" type="button">
</center><br>
<!-- 共通フッター -->
<div id="foot">
Copyright&#169; Office TANAKA 1995-2009. All rights reserved.
</div></div></div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="Office%20TANAKA%20-%20Excel%20VBA%E8%AC%9B%E5%BA%A7%EF%BC%9A%E3%82%BB%E3%83%AB%E3%81%AE%E6%93%8D%E4%BD%9C%5B%E7%BD%AB%E7%B7%9A%E3%81%AE%E8%A8%AD%E5%AE%9A%5D_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-10614788-1");
pageTracker._trackPageview();
} catch(err) {}</script>





</body></html>